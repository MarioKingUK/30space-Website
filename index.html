<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>30Space</title>
    <style>
        :root {
            --dust-yellow: #fff08a;
        }

        .dust-layer {
            position: absolute;
            inset: 0;
            pointer-events: none;
            overflow: hidden;
            z-index: 10;
        }

        .dust-number {
            position: absolute;
            left: 0;
            top: 0;
            color: var(--dust-yellow);
            font-weight: 700;
            line-height: 1;
            text-shadow: 0 0 8px rgba(255, 238, 120, 0.35);
            opacity: 0.32;
            will-change: transform, opacity;
            animation: dust-flow var(--dur) ease-in-out var(--delay) infinite alternate;
            transform: translate3d(var(--start-x), var(--start-y), 0);
        }

        .dust-number.burst {
            animation-duration: calc(var(--dur) * 0.2) !important;
            opacity: 0.78;
        }

        .space-word {
            position: relative;
            display: inline-block;
        }

        .p-anchor {
            position: relative;
            display: inline-block;
        }

        .p-character {
            position: absolute;
            left: 0.07em;
            bottom: 0.65em;
            width: 0.114em;
            height: auto;
            pointer-events: none;
            user-select: none;
            z-index: 3;
            transform-origin: center bottom;
            will-change: transform;
        }

        .p-character.is-jumping {
            animation: character-jump 560ms cubic-bezier(0.22, 0.75, 0.2, 1) 1;
        }

        @keyframes character-jump {
            0% {
                transform: translateY(0) scale(1, 1);
            }
            20% {
                transform: translateY(0.01em) scale(1.04, 0.96);
            }
            45% {
                transform: translateY(-0.24em) scale(0.98, 1.03) rotate(-2deg);
            }
            65% {
                transform: translateY(-0.34em) scale(1, 1) rotate(1deg);
            }
            85% {
                transform: translateY(-0.12em) scale(1.01, 0.99);
            }
            100% {
                transform: translateY(0) scale(1, 1);
            }
        }

        @keyframes dust-flow {
            0% {
                transform: translate3d(var(--start-x), var(--start-y), 0) rotate(0deg);
                opacity: 0.16;
            }
            20% {
                opacity: 0.45;
            }
            50% {
                transform: translate3d(calc(var(--start-x) + var(--drift-x) * 0.6), calc(var(--start-y) + var(--drift-y) * 0.6), 0) rotate(calc(var(--spin) * 0.6));
                opacity: 0.52;
            }
            100% {
                transform: translate3d(calc(var(--start-x) + var(--drift-x)), calc(var(--start-y) + var(--drift-y)), 0) rotate(var(--spin));
                opacity: 0.14;
            }
        }
    </style>
</head>
<body class="bg-[#FFD700] m-0 p-0 antialiased font-sans">
    <main id="main-area" class="relative flex flex-col items-center w-full min-h-screen overflow-hidden">
        <div id="dust-layer" class="dust-layer" aria-hidden="true"></div>

        <div id="title-cluster" class="relative z-20 flex flex-col items-center w-auto px-4 pt-[360px] gap-[10px]">
            <h1 id="title-text" class="text-black text-[clamp(72px,16vw,160px)] leading-none tracking-tight whitespace-nowrap">
                <span class="font-light text-[#8B4513]">30</span><span class="font-extrabold space-word">S<span id="p-anchor" class="p-anchor">p<img id="p-character" src="front.png" alt="" class="p-character" aria-hidden="true"></span>ace</span>
            </h1>

            <a href="mailto:contact@30space.com"
               class="text-[#E4171A] text-[10pt] font-medium hover:underline whitespace-nowrap">
                contact@30space.com
            </a>
        </div>
    </main>

    <script>
        const PARTICLE_COUNT = 30;
        const MIN_NUMBER = 10;
        const MAX_NUMBER = 40;
        const FRONT_SRC = "front.png";
        const LEFT_SRC = "left.png";
        const RIGHT_SRC = "right.png";
        const JUMP_SRC = "back_jump.png";
        const particles = [];
        const mainArea = document.getElementById("main-area");
        const dustLayer = document.getElementById("dust-layer");
        const titleCluster = document.getElementById("title-cluster");
        const titleText = document.getElementById("title-text");
        const pAnchor = document.getElementById("p-anchor");
        const character = document.getElementById("p-character");

        let jumpLock = false;
        let lastJumpAt = 0;

        function random(min, max) {
            return Math.random() * (max - min) + min;
        }

        function randomInt(min, max) {
            return Math.floor(random(min, max + 1));
        }

        function setCharacterFacing(src) {
            if (!character || jumpLock || character.src.endsWith(src)) {
                return;
            }
            character.src = src;
        }

        function jumpCharacter() {
            if (!character) {
                return;
            }

            const now = window.performance.now();
            if (jumpLock || now - lastJumpAt < 420) {
                return;
            }

            jumpLock = true;
            lastJumpAt = now;
            character.src = JUMP_SRC;
            character.classList.remove("is-jumping");
            void character.offsetWidth;
            character.classList.add("is-jumping");

            window.setTimeout(() => {
                character.classList.remove("is-jumping");
                character.src = FRONT_SRC;
                jumpLock = false;
            }, 560);
        }

        function isInsideRect(x, y, rect) {
            return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;
        }

        function handleInteractionPoint(x, y) {
            if (!titleText || !pAnchor) {
                return;
            }

            const titleRect = titleText.getBoundingClientRect();
            const pRect = pAnchor.getBoundingClientRect();
            const pCenterX = pRect.left + pRect.width / 2;
            const inTitle = isInsideRect(x, y, titleRect);
            const inTopOutsideTitle = y < titleRect.top && y >= 0;

            if (inTitle) {
                if (x < pCenterX) {
                    setCharacterFacing(LEFT_SRC);
                } else {
                    setCharacterFacing(RIGHT_SRC);
                }
                return;
            }

            if (inTopOutsideTitle) {
                jumpCharacter();
                return;
            }

            setCharacterFacing(FRONT_SRC);
        }

        function handlePointerMove(event) {
            handleInteractionPoint(event.clientX, event.clientY);
        }

        function handleTouch(event) {
            const touch = event.touches[0] || event.changedTouches[0];
            if (!touch) {
                return;
            }
            handleInteractionPoint(touch.clientX, touch.clientY);
        }

        function placeParticles() {
            particles.length = 0;
            dustLayer.innerHTML = "";

            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const titleRect = titleCluster.getBoundingClientRect();
            const centerX = titleRect.left + titleRect.width / 2;
            const centerY = titleRect.top + titleRect.height / 2;

            const numberPool = Array.from({ length: MAX_NUMBER - MIN_NUMBER + 1 }, (_, index) => MIN_NUMBER + index)
                .sort(() => Math.random() - 0.5)
                .slice(0, Math.min(PARTICLE_COUNT, MAX_NUMBER - MIN_NUMBER + 1));

            for (let i = 0; i < numberPool.length; i += 1) {
                const value = numberPool[i];
                const node = document.createElement("span");

                node.className = "dust-number";
                node.textContent = String(value);
                node.style.fontSize = `${value}px`;
                node.style.setProperty("--dur", `${random(7.5, 15.5).toFixed(2)}s`);
                node.style.setProperty("--delay", `${random(-8, 0).toFixed(2)}s`);
                node.style.setProperty("--spin", `${random(-30, 30).toFixed(2)}deg`);

                const startX = Math.max(0, Math.min(viewportWidth - value, centerX + random(-360, 360)));
                const startY = Math.max(0, Math.min(viewportHeight - value, centerY + random(-110, 110)));
                const driftX = random(-320, 320);
                const driftY = random(-320, 320);

                node.style.setProperty("--start-x", `${startX.toFixed(2)}px`);
                node.style.setProperty("--start-y", `${startY.toFixed(2)}px`);
                node.style.setProperty("--drift-x", `${driftX.toFixed(2)}px`);
                node.style.setProperty("--drift-y", `${driftY.toFixed(2)}px`);

                dustLayer.appendChild(node);
                particles.push(node);
            }
        }

        function triggerBurst() {
            const burstCount = randomInt(2, 5);
            const shuffled = [...particles].sort(() => Math.random() - 0.5);
            const picked = shuffled.slice(0, burstCount);

            picked.forEach((node) => node.classList.add("burst"));
            window.setTimeout(() => {
                picked.forEach((node) => node.classList.remove("burst"));
            }, 800);

            window.setTimeout(triggerBurst, random(2200, 4800));
        }

        if (mainArea) {
            mainArea.addEventListener("pointermove", handlePointerMove);
            mainArea.addEventListener("touchstart", handleTouch, { passive: true });
            mainArea.addEventListener("touchmove", handleTouch, { passive: true });
            mainArea.addEventListener("pointerleave", () => {
                setCharacterFacing(FRONT_SRC);
            });
        }

        placeParticles();
        triggerBurst();

        window.addEventListener("resize", () => {
            placeParticles();
        });
    </script>
</body>
</html>
